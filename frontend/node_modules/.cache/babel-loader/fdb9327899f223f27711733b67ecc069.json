{"ast":null,"code":"import { db } from \"./base\";\nimport firebase from \"firebase/app\";\n\nconst checkUserExist = async uid => {\n  const docRef = db.collection(\"users\").doc(uid);\n  const doc = await docRef.get();\n\n  if (!doc.exists) {\n    return true;\n  } else {\n    return false;\n  }\n};\n\nconst addUser = async (uid, val) => {\n  const docRef = db.collection(\"users\").doc(uid);\n  let userRole = {\n    role: null\n  };\n\n  if (val) {\n    userRole.role = true;\n  } else {\n    userRole.role = false;\n  }\n\n  await docRef.set(userRole);\n};\n\nconst addInfo = async (values, uid) => {\n  const docRef = db.collection(\"users\").doc(uid);\n  await docRef.update(values);\n};\n\nconst addClass = (code, uid) => {\n  const docRef = db.collection(\"classes\").doc(code);\n  let data = {\n    classCode: code,\n    className: \"Class\" + code,\n    owner: uid,\n    students: null\n  };\n  docRef.set(data);\n  addClassToUser(code, uid);\n};\n\nconst joinClass = async (code, uid) => {\n  try {\n    const classesRef = db.collection(\"classes\").doc(code);\n    await classesRef.update({\n      students: firebase.firestore.FieldValue.arrayUnion(uid)\n    });\n    addClassToUser(code, uid);\n  } catch (err) {\n    return err;\n  }\n};\n\nconst getAllClasses = async uid => {\n  const docRef = db.collection(\"users\").doc(uid);\n  const doc = await docRef.get();\n  const {\n    Classes\n  } = doc.data();\n  console.log(Classes);\n  const classAr = [];\n\n  for (const code of Classes) {\n    const classRef = db.collection(\"classes\").doc(code);\n    const docData = await classRef.get();\n    const classData = docData.data();\n    classAr.push(classData);\n  }\n\n  return classAr;\n};\n\nconst addClassToUser = async (code, uid) => {\n  const docRef = db.collection(\"users\").doc(uid);\n  await docRef.update({\n    Classes: firebase.firestore.FieldValue.arrayUnion(code)\n  });\n};\n\nconst getUserRole = async uid => {\n  const docRef = db.collection(\"users\").doc(uid);\n  const doc = await docRef.get();\n  const data = doc.data();\n  return data;\n};\n\nexport { checkUserExist, addUser, getUserRole, addClass, joinClass, addInfo, getAllClasses };","map":{"version":3,"sources":["C:/Users/Noel/Desktop/Javascript/Node.js/CheaterChecker/frontend/src/utils/Firestore.js"],"names":["db","firebase","checkUserExist","uid","docRef","collection","doc","get","exists","addUser","val","userRole","role","set","addInfo","values","update","addClass","code","data","classCode","className","owner","students","addClassToUser","joinClass","classesRef","firestore","FieldValue","arrayUnion","err","getAllClasses","Classes","console","log","classAr","classRef","docData","classData","push","getUserRole"],"mappings":"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","sourcesContent":["import { db } from \"./base\";\r\nimport firebase from \"firebase/app\";\r\nconst checkUserExist = async (uid) => {\r\n  const docRef = db.collection(\"users\").doc(uid);\r\n  const doc = await docRef.get();\r\n\r\n  if (!doc.exists) {\r\n    return true;\r\n  } else {\r\n    return false;\r\n  }\r\n};\r\n\r\nconst addUser = async (uid, val) => {\r\n  const docRef = db.collection(\"users\").doc(uid);\r\n  let userRole = {\r\n    role: null,\r\n  };\r\n  if (val) {\r\n    userRole.role = true;\r\n  } else {\r\n    userRole.role = false;\r\n  }\r\n  await docRef.set(userRole);\r\n};\r\n\r\nconst addInfo = async (values, uid) => {\r\n  const docRef = db.collection(\"users\").doc(uid);\r\n  await docRef.update(values);\r\n};\r\nconst addClass = (code, uid) => {\r\n  const docRef = db.collection(\"classes\").doc(code);\r\n  let data = {\r\n    classCode: code,\r\n    className: \"Class\" + code,\r\n    owner: uid,\r\n    students: null,\r\n  };\r\n  docRef.set(data);\r\n  addClassToUser(code, uid);\r\n};\r\nconst joinClass = async (code, uid) => {\r\n  try {\r\n    const classesRef = db.collection(\"classes\").doc(code);\r\n    await classesRef.update({\r\n      students: firebase.firestore.FieldValue.arrayUnion(uid),\r\n    });\r\n    addClassToUser(code, uid);\r\n  } catch (err) {\r\n    return err;\r\n  }\r\n};\r\nconst getAllClasses = async (uid) => {\r\n  const docRef = db.collection(\"users\").doc(uid);\r\n  const doc = await docRef.get();\r\n  const { Classes } = doc.data();\r\n  console.log(Classes);\r\n  const classAr = [];\r\n  for (const code of Classes) {\r\n    const classRef = db.collection(\"classes\").doc(code);\r\n    const docData = await classRef.get();\r\n    const classData = docData.data();\r\n    classAr.push(classData);\r\n  }\r\n  return classAr;\r\n};\r\nconst addClassToUser = async (code, uid) => {\r\n  const docRef = db.collection(\"users\").doc(uid);\r\n  await docRef.update({\r\n    Classes: firebase.firestore.FieldValue.arrayUnion(code),\r\n  });\r\n};\r\nconst getUserRole = async (uid) => {\r\n  const docRef = db.collection(\"users\").doc(uid);\r\n  const doc = await docRef.get();\r\n  const data = doc.data();\r\n  return data;\r\n};\r\n\r\nexport {\r\n  checkUserExist,\r\n  addUser,\r\n  getUserRole,\r\n  addClass,\r\n  joinClass,\r\n  addInfo,\r\n  getAllClasses,\r\n};\r\n"]},"metadata":{},"sourceType":"module"}